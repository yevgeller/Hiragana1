@using Hiragana1.Shared;
@using Hiragana1.Shared.DTOs;

@if (!TestQuestion.Answers.Any())
{
    <p><em>Loading test question...</em></p>
}
else
{
    <h3 class="align-content-center">@TestQuestion?.Question</h3>
    <div class="d-flex flex-row bd-highlight flex-wrap">
    @foreach(var a in TestQuestion?.Answers)
    {
        <AnswerButton ButtonText="@a" IsCorrect="IsThisAnswerCorrect(a)" OnCorrectAnswer="AnsweredCorrectly"></AnswerButton>
    }
    </div>
}
@code {

    [Parameter]
    public QuestionDto? TestQuestion { get; set; }

    [Parameter] public EventCallback<bool> OnAnswer { get; set; }

    private async Task CompareAnswer(string value)
    {
        bool isCorrectAnswer = string.Compare(value, this.TestQuestion?.CorrectAnswer, true) == 0;

        await OnAnswer.InvokeAsync(isCorrectAnswer);
    }

    private async Task AnsweredCorrectly(bool isCorrect)
    {
        await OnAnswer.InvokeAsync(isCorrect);
    }

    private bool IsThisAnswerCorrect(string answer)
    {
        return answer == TestQuestion?.CorrectAnswer;
    }
}



